<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
<meta property="og:title" content="Writing and Reading TFRecords" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="tutorials/1_read_write_tfrecords.html" />
  
<meta property="og:description" content="Tensoflow-Transformers has off the shelf support to write and read tfrecord with so much ease. It also allows you to shard, shuffle and batch your data most ..." />
  
<meta property="og:image" content="png location" />
  
<meta property="og:image:alt" content="Writing and Reading TFRecords" />
  
<meta name="twitter:image" content="png location">
<meta name="twitter:description" content="State-of-the-art Faster Transformer (NLP,CV,Audio) Based models in Tensorflow 2.0">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Writing and Reading TFRecords &mdash; TF Transformers   documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom_from_huggingface.css" type="text/css" /><link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script >let toggleHintShow = 'Click to show';</script>
        <script >let toggleHintHide = 'Click to hide';</script>
        <script >let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Classify text (MRPC) with Albert" href="2_text_classification_imdb_albert.html" />
    <link rel="prev" title="Model Parallelism" href="../model_doc/parallelism.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html"><img src="../_static/transformers_mix.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                 
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction_docs/quicktour.html">Quick tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction_docs/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction_docs/philosophy.html">Philosophy</a></li>
</ul>
<p class="caption"><span class="caption-text">Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../model_doc/albert.html">ALBERT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_doc/bert.html">BERT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_doc/gpt2.html">OpenAI GPT2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_doc/t5.html">T5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_doc/mt5.html">MT5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_doc/roberta.html">RoBERTa</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_doc/vit.html">Vision Transformer (ViT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_doc/parallelism.html">Model Parallelism</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Writing and Reading TFRecords</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#load-data-and-tokenizer">Load Data and Tokenizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#write-tfrecord">Write TFRecord</a></li>
<li class="toctree-l2"><a class="reference internal" href="#read-tfrecords">Read TFRecords</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="2_text_classification_imdb_albert.html">Classify text (MRPC) with Albert</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_masked_lm_tpu.html">Train (Masked Language Model) with tf-transformers in TPU</a></li>
</ul>
<p class="caption"><span class="caption-text">Tokenizers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../model_doc/albert_tokenizer.html">ALBERT Tokenizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_doc/bigbird_tokenizer.html">BigBird Roberta Tokenizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_doc/t5_tokenizer.html">T5 Tokenizer</a></li>
</ul>
<p class="caption"><span class="caption-text">Research</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../research/glue.html">Glue Model Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../research/long_block_sequencer.html">Long Block Sequencer</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmarks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks/gpt2.html">Benchmark GPT2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks/t5.html">Benchmark T5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks/albert.html">Benchmark Albert</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks/vit.html">Benchmark ViT</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TF Transformers</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Writing and Reading TFRecords</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/1_read_write_tfrecords.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="tex2jax_ignore mathjax_ignore section" id="writing-and-reading-tfrecords">
<h1>Writing and Reading TFRecords<a class="headerlink" href="#writing-and-reading-tfrecords" title="Permalink to this headline">¶</a></h1>
<p>Tensoflow-Transformers has off the shelf support to write and read tfrecord with so much ease.
It also allows you to shard, shuffle and batch your data most of the times, with minimal code.</p>
<p>Here we will see, how can we make use of these utilities to write and read tfrecords.</p>
<p>For this examples, we will be using a <a class="reference external" href="https://huggingface.co/datasets/squad"><strong>Squad Dataset</strong></a>, to convert it to a text to text problem using
GPT2 Tokenizer. TFRecords are useful for efficient training pipelines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tf_transformers.data</span> <span class="kn">import</span> <span class="n">TFWriter</span><span class="p">,</span> <span class="n">TFReader</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">GPT2TokenizerFast</span>

<span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>

<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">glob</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="load-data-and-tokenizer">
<h2>Load Data and Tokenizer<a class="headerlink" href="#load-data-and-tokenizer" title="Permalink to this headline">¶</a></h2>
<p>We will load dataset and tokenizer. Then we will define the length for the examples.
It is important to make sure we have limit the length within the allowed limit of each models.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load Dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;squad&quot;</span><span class="p">)</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">GPT2TokenizerFast</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;gpt2&#39;</span><span class="p">)</span>

<span class="c1"># Define length for examples</span>
<span class="n">max_passage_length</span> <span class="o">=</span> <span class="mi">384</span>
<span class="n">max_question_length</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">max_answer_length</span> <span class="o">=</span> <span class="mi">40</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="write-tfrecord">
<h2>Write TFRecord<a class="headerlink" href="#write-tfrecord" title="Permalink to this headline">¶</a></h2>
<p>To write a TFRecord, we need to provide a schema (<strong>dict</strong>). This schema supports <strong>int</strong>, <strong>float</strong>, <strong>bytes</strong>.</p>
<p><strong>TFWriter</strong>, support <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/io/FixedLenFeature"><strong>FixedLen</strong></a> and
<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/io/VarLenFeature"><strong>VarLen</strong></a> feature types.</p>
<p>The recommended and easiest is to use <strong>Varlen</strong>, this will be faster and easy to write and read.
We can also pad it accordingly after reading.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">parse_train</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">max_passage_length</span><span class="p">,</span> <span class="n">max_question_length</span><span class="p">,</span> <span class="n">max_answer_length</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function o to parse examples</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (:obj:`dataet`): HF dataset</span>
<span class="sd">        tokenizer (:obj:`tokenizer`): HF Tokenizer</span>
<span class="sd">        max_passage_length (:obj:`int`): Passage Length</span>
<span class="sd">        max_question_length (:obj:`int`): Question Length</span>
<span class="sd">        max_answer_length (:obj:`int`): Answer Length</span>
<span class="sd">        key (:obj:`str`): Key of dataset (`train`, `validation` etc)</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
        <span class="n">question_input_ids</span> <span class="o">=</span>  <span class="n">tokenizer</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;context&#39;</span><span class="p">],</span> <span class="n">max_length</span><span class="o">=</span><span class="n">max_passage_length</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">bos_token_id</span><span class="p">]</span>
        <span class="n">passage_input_ids</span>  <span class="o">=</span>  <span class="n">tokenizer</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;question&#39;</span><span class="p">],</span> <span class="n">max_length</span><span class="o">=</span><span class="n">max_question_length</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span>  <span class="o">+</span> \
        <span class="p">[</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">bos_token_id</span><span class="p">]</span> 
        
        <span class="c1"># Input Question + Context</span>
        <span class="c1"># We should make sure that we will mask labels here,as we dont want model to predict inputs</span>
        <span class="n">input_ids</span> <span class="o">=</span> <span class="n">question_input_ids</span> <span class="o">+</span> <span class="n">passage_input_ids</span>
        <span class="n">labels_mask</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_ids</span><span class="p">)</span>
        
        <span class="c1"># Answer part</span>
        <span class="n">answer_ids</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;answers&#39;</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">max_length</span><span class="o">=</span><span class="n">max_answer_length</span><span class="p">,</span> <span class="n">truncation</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span> <span class="o">+</span> \
        <span class="p">[</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">bos_token_id</span><span class="p">]</span>
        <span class="n">input_ids</span> <span class="o">=</span> <span class="n">input_ids</span> <span class="o">+</span> <span class="n">answer_ids</span>
        <span class="n">labels_mask</span> <span class="o">=</span> <span class="n">labels_mask</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">answer_ids</span><span class="p">)</span>
        
        <span class="c1"># Shift positions to make proper training examples</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">input_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">labels_mask</span> <span class="o">=</span> <span class="n">labels_mask</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        
        <span class="n">input_ids</span> <span class="o">=</span> <span class="n">input_ids</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_ids</span>
        
        <span class="n">result</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>
        <span class="n">result</span><span class="p">[</span><span class="s1">&#39;labels_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels_mask</span>
        
        <span class="k">yield</span> <span class="n">result</span>
        
<span class="c1"># Write using TF Writer</span>

<span class="n">schema</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;input_ids&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;var_len&quot;</span><span class="p">,</span> <span class="s2">&quot;int&quot;</span><span class="p">),</span>
    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;var_len&quot;</span><span class="p">,</span> <span class="s2">&quot;int&quot;</span><span class="p">),</span>
    <span class="s2">&quot;labels_mask&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;var_len&quot;</span><span class="p">,</span> <span class="s2">&quot;int&quot;</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">tfrecord_train_dir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
<span class="n">tfrecord_filename</span> <span class="o">=</span> <span class="s1">&#39;squad&#39;</span>

<span class="n">tfwriter</span> <span class="o">=</span> <span class="n">TFWriter</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span> 
                    <span class="n">file_name</span><span class="o">=</span><span class="n">tfrecord_filename</span><span class="p">,</span> 
                    <span class="n">model_dir</span><span class="o">=</span><span class="n">tfrecord_train_dir</span><span class="p">,</span>
                    <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span>
                    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
                    <span class="p">)</span>

<span class="c1"># Train dataset</span>
<span class="n">train_parser_fn</span> <span class="o">=</span> <span class="n">parse_train</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">max_passage_length</span><span class="p">,</span> <span class="n">max_question_length</span><span class="p">,</span> <span class="n">max_answer_length</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="n">tfwriter</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">parse_fn</span><span class="o">=</span><span class="n">train_parser_fn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="read-tfrecords">
<h2>Read TFRecords<a class="headerlink" href="#read-tfrecords" title="Permalink to this headline">¶</a></h2>
<p>To read a TFRecord, we need to provide a schema (<strong>dict</strong>). This schema supports <strong>int</strong>, <strong>float</strong>, <strong>bytes</strong>.</p>
<p><strong>TFWReader</strong>, support <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/io/FixedLenFeature"><strong>FixedLen</strong></a> and
<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/io/VarLenFeature"><strong>VarLen</strong></a> feature types.
We can also <strong>auto_batch</strong>, <strong>shuffle</strong>, choose the optional keys (not all keys in tfrecords) might not be required while reading, etc in a single function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read TFRecord</span>

<span class="n">schema</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/schema.json&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tfrecord_train_dir</span><span class="p">)))</span>
<span class="n">all_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/*.tfrecord&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tfrecord_train_dir</span><span class="p">))</span>
<span class="n">tf_reader</span> <span class="o">=</span> <span class="n">TFReader</span><span class="p">(</span><span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span> 
                    <span class="n">tfrecord_files</span><span class="o">=</span><span class="n">all_files</span><span class="p">)</span>

<span class="n">x_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;input_ids&#39;</span><span class="p">]</span>
<span class="n">y_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">,</span> <span class="s1">&#39;labels_mask&#39;</span><span class="p">]</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">tf_reader</span><span class="o">.</span><span class="n">read_record</span><span class="p">(</span><span class="n">auto_batch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                   <span class="n">keys</span><span class="o">=</span><span class="n">x_keys</span><span class="p">,</span>
                                   <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> 
                                   <span class="n">x_keys</span> <span class="o">=</span> <span class="n">x_keys</span><span class="p">,</span> 
                                   <span class="n">y_keys</span> <span class="o">=</span> <span class="n">y_keys</span><span class="p">,</span>
                                   <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                   <span class="n">drop_remainder</span><span class="o">=</span><span class="kc">True</span>
                                  <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">batch_inputs</span><span class="p">,</span> <span class="n">batch_labels</span><span class="p">)</span> <span class="ow">in</span> <span class="n">train_dataset</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch_inputs</span><span class="p">,</span> <span class="n">batch_labels</span><span class="p">)</span>
    <span class="k">break</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../model_doc/parallelism.html" class="btn btn-neutral float-left" title="Model Parallelism" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="2_text_classification_imdb_albert.html" class="btn btn-neutral float-right" title="Classify text (MRPC) with Albert" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, The TFT Team, Licenced under the Apache License, Version 2.0.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-83738774-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-83738774-2', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>